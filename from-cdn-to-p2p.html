<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>From CDN to P2P: a Brief Dataset Analysis for Video Streaming</title>
  <meta name="description" content="A brief study of two different video streaming techniques.">
  <link rel="canonical" href="http://localhost:4000/blog/from-cdn-to-p2p">
  <link rel="alternate" type="application/rss+xml" title="Ahmed Akakzia Feed"
    href="http://localhost:4000/blog/feed.xml">
  
  <link rel="shortcut icon" href="/blog/images/tabicon.png" type="image/png" />
  
  <!-- Styles -->
  <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%7CNoto+Serif:400,400i,700,700i&display=swap" rel="stylesheet">
  <link href="/blog/assets/css/style.css" rel="stylesheet">
</head>
<body>

  <div id="page" class="site">
    <div class="inner">
      <header class="site-header">
  
  <p class="site-title"><a class="logo-text" href="/blog/">Ahmed Akakzia</a></p>
  
  <nav class="site-navigation">
    <div class="site-navigation-wrap">
      <h2 class="screen-reader-text">Main navigation</h2>
      <ul class="menu">
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/">Scientific Lab</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/publications/">Publications</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/about/">About</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/contact/">Contact</a>
        </li>
        
      </ul><!-- .menu -->
      <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span
          class="icon-close" aria-hidden="true"></span></button>
    </div><!-- .site-navigation-wrap -->
  </nav><!-- .site-navigation -->
  <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
</header>


      <main class="main-content fadeInDown delay_075s">

  <article class="post">
    <header class="post-header">
      <time class="post-date" datetime="2019-03-10">March 10, 2019</time>
      <h1 class="post-title">From CDN to P2P: a Brief Dataset Analysis for Video Streaming</h1>
      <div class="post-meta">
        By <span class="post-author">Ahmed Akakzia</span>
      </div><!-- .post-meta -->
      
      <figure class="post-thumbnail image-card width-wide">
        <img src="/blog/images/video_streaming.png" alt="From CDN to P2P: a Brief Dataset Analysis for Video Streaming">
      </figure><!-- .post-thumbnail -->
      
    </header><!-- .post-header -->
    <div class="post-content">
      <blockquote>
  <p>Recently, peer-to-peer technology has been welcoming many “shifters” that chose to quit content distribution networks. The reason behind this is the self-scalability of P2P systems provided by the principles of communal collaboration and resource sharing in P2P systems. By building a P2P Content Distribution Network (CDN), peers collaborate to distribute the content of under-provisioned websites and to serve queries for large audiences on behalf of the websites. When designing a P2P CDN, the main challenge is to actually maintain an acceptable level of performance in terms of client-perceived latency and hit ratio while minimizing the incurred overhead.</p>
</blockquote>

<!--more-->

<p>This is not a straightforward endeavor given that the P2P CDN relies on autonomous and dynamic peers rather than a dedicated infrastructure. Indeed, the distribution of duties and content over peers should take into account their interests in order to give them proper incentives to cooperate. Moreover, the P2P-CDN should adapt to increasing numbers of participants and provide robust algorithms under high levels of churn because these issues have a key impact on performance. Finally, the routing of queries should aim peers close in locality and serve content from close-by providers to achieve short latencies.</p>

<p>In this notebook, I will be trying to analyze a dataset about peer-to-peer and cdn content retrieval during nine streams. Each row of the dataset corresponds to a user’s informations for a given stream :</p>
<ul>
  <li>The ID of the stream</li>
  <li>The Internet Service Providor</li>
  <li>The type of the browser</li>
  <li>The status : connected or not</li>
  <li>P2p retrieval</li>
  <li>Cdn retrieval</li>
</ul>

<p>My two objectives are the following :</p>
<ul>
  <li>Exploring the dataset.</li>
  <li>Giving some recommendations so that to improve the streaming service.</li>
</ul>

<p>My approach will be as following : first, I will start with an exploratory data analysis, including some feature processing which will be useful for some interesting plots. Then, according to those visualizations and some personal reads, I will be trying to give some recommendation as to improve the streaming service.</p>

<h2 id="table-of-contents-">Table of Contents :</h2>

<ol>
  <li><a href="#un">Exploratory data analysis.<br /><br /></a></li>
  <li><a href="#deux">Recommendations.<br /></a></li>
</ol>

<p><a id="un"></a></p>
<h2 id="exploratory-data-analysis">Exploratory data analysis</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data.csv'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#stream</th>
      <th>isp</th>
      <th>browser</th>
      <th>connected</th>
      <th>p2p</th>
      <th>cdn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Fro</td>
      <td>Iron</td>
      <td>True</td>
      <td>195910.840977</td>
      <td>109025.960619</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Fro</td>
      <td>EarthWolf</td>
      <td>True</td>
      <td>186711.522041</td>
      <td>113744.856814</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Arange</td>
      <td>Iron</td>
      <td>True</td>
      <td>189428.293434</td>
      <td>115944.246844</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Arange</td>
      <td>Iron</td>
      <td>True</td>
      <td>0.000000</td>
      <td>307577.191067</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>BTP</td>
      <td>EarthWolf</td>
      <td>True</td>
      <td>207246.640473</td>
      <td>107010.608093</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>ISP</strong> : Internet Service Provider<br />
<strong>P2P</strong> : (Peer-to-peer) : a distributed application architecture that partitions tasks or workloads between peers. Peers are equally privileged, equipotent participants in the application. <br />
<strong>CDN</strong> : (Content diffusion network)  a geographically distributed network of proxy servers and their data centers. <br /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#stream        int64
isp           object
browser       object
connected       bool
p2p          float64
cdn          float64
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#stream      0
isp          0
browser      0
connected    0
p2p          0
cdn          1
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">'cdn'</span><span class="p">].</span><span class="n">isnull</span><span class="p">()]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#stream</th>
      <th>isp</th>
      <th>browser</th>
      <th>connected</th>
      <th>p2p</th>
      <th>cdn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>534953</th>
      <td>9</td>
      <td>BTP</td>
      <td>EarthWolf</td>
      <td>True</td>
      <td>6100.582815</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>We note that there one single NaN value in the dataset. We will deal with it later during the preprocessing</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">connected</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True     485753
False     49201
Name: connected, dtype: int64
</code></pre></div></div>

<p>Here we see that the number of users that are not connected to the p2p is small compared with the number of users that are actually connected. Thereof, we can consider not connected users as “outliers”, or “distrubing” users. This will be further discussed later on.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">corr</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#stream</th>
      <th>connected</th>
      <th>p2p</th>
      <th>cdn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>#stream</th>
      <td>1.000000</td>
      <td>-0.220267</td>
      <td>0.329506</td>
      <td>0.233442</td>
    </tr>
    <tr>
      <th>connected</th>
      <td>-0.220267</td>
      <td>1.000000</td>
      <td>0.090586</td>
      <td>0.086500</td>
    </tr>
    <tr>
      <th>p2p</th>
      <td>0.329506</td>
      <td>0.090586</td>
      <td>1.000000</td>
      <td>0.304800</td>
    </tr>
    <tr>
      <th>cdn</th>
      <td>0.233442</td>
      <td>0.086500</td>
      <td>0.304800</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<p>There is a correlation between cdn / p2p and the stream. This is absolutely normal since the amount of retrieval depends on the nature of the video that is currently being broadcasted</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 5 Internet service providors
</span><span class="n">data</span><span class="p">.</span><span class="n">isp</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Arange           165341
Fro              149789
BTP              130317
Datch Telecam     45655
Olga              43852
Name: isp, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 Types of browsers
</span><span class="n">data</span><span class="p">.</span><span class="n">browser</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>EarthWolf    283311
Iron         217246
Vectrice      20970
Swamp         13427
Name: browser, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">data_preprocessing</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="n">pd</span><span class="p">.</span><span class="n">options</span><span class="p">.</span><span class="n">mode</span><span class="p">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="s">"""
    Dealing with the single NaN value in the cdn value : Replace it with average cdn on rows in which p2p != 0 for corresponsing
    #stream
    """</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Dealing with NaN ...'</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="s">'cdn'</span><span class="p">].</span><span class="n">isnull</span><span class="p">()][</span><span class="s">'cdn'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dataset</span><span class="p">[(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'#stream'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span>
                                                          <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'p2p'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">)].</span><span class="n">cdn</span><span class="p">)</span>
    
    <span class="s">"""
    Adding two more features : total amount from cdn and p2p + percentage of p2p for each row
    """</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Adding features ...'</span><span class="p">)</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s">'total'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'p2p'</span><span class="p">]</span> <span class="o">+</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'cdn'</span><span class="p">]</span>
    <span class="n">dataset</span><span class="p">[</span><span class="s">'% p2p'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'p2p'</span><span class="p">]</span> <span class="o">/</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'total'</span><span class="p">]</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">'Preprocessing completed succesfully !'</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dataset</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_preprocessed</span> <span class="o">=</span> <span class="n">data_preprocessing</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Dealing with NaN ...
Adding features ...
Preprocessing completed succesfully !
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_preprocessed</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>#stream</th>
      <th>isp</th>
      <th>browser</th>
      <th>connected</th>
      <th>p2p</th>
      <th>cdn</th>
      <th>total</th>
      <th>% p2p</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Fro</td>
      <td>Iron</td>
      <td>True</td>
      <td>195910.840977</td>
      <td>109025.960619</td>
      <td>304936.801596</td>
      <td>64.246375</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Fro</td>
      <td>EarthWolf</td>
      <td>True</td>
      <td>186711.522041</td>
      <td>113744.856814</td>
      <td>300456.378855</td>
      <td>62.142639</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Arange</td>
      <td>Iron</td>
      <td>True</td>
      <td>189428.293434</td>
      <td>115944.246844</td>
      <td>305372.540278</td>
      <td>62.031869</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Arange</td>
      <td>Iron</td>
      <td>True</td>
      <td>0.000000</td>
      <td>307577.191067</td>
      <td>307577.191067</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>BTP</td>
      <td>EarthWolf</td>
      <td>True</td>
      <td>207246.640473</td>
      <td>107010.608093</td>
      <td>314257.248566</td>
      <td>65.948086</td>
    </tr>
  </tbody>
</table>
</div>

<ul>
  <li>There are some users that are connected to the p2p but get all the content from cdn (first viewers ? distributed CDN ?)</li>
  <li>There are users not connected but are part of the p2p = outliers, create noise</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Analysing the not connected users : 
</span><span class="n">not_connected</span> <span class="o">=</span> <span class="n">data_preprocessed</span><span class="p">[</span><span class="n">data_preprocessed</span><span class="p">[</span><span class="s">'connected'</span><span class="p">]</span> <span class="o">==</span> <span class="bp">False</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">not_connected</span><span class="p">.</span><span class="n">browser</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>EarthWolf    24076
Iron         22846
Swamp         1288
Vectrice       991
Name: browser, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">not_connected</span><span class="p">.</span><span class="n">isp</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Datch Telecam    36415
Fro               7524
Olga              3483
Arange            1641
BTP                138
Name: isp, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bar_not_connected</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">not_connected</span><span class="p">):</span>
    <span class="n">temp_1</span> <span class="o">=</span> <span class="n">not_connected</span><span class="p">.</span><span class="n">isp</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">temp_2</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">isp</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">temp_3</span> <span class="o">=</span> <span class="n">not_connected</span><span class="p">.</span><span class="n">browser</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">temp_4</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">browser</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">proportions_isp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">temp_1</span> <span class="o">/</span> <span class="n">temp_2</span><span class="p">))</span>
    <span class="n">proportions_browser</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">temp_3</span> <span class="o">/</span> <span class="n">temp_4</span><span class="p">))</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">bar</span><span class="p">(</span><span class="n">proportions_browser</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">proportions_browser</span><span class="p">[</span><span class="s">'browser'</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'crimson'</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">bar</span><span class="p">(</span><span class="n">proportions_isp</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">proportions_isp</span><span class="p">[</span><span class="s">'isp'</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'darkblue'</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bar_not_connected</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">not_connected</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(&lt;Figure size 864x288 with 2 Axes&gt;,
 array([&lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001E743692E10&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x000001E73F5100B8&gt;],
       dtype=object))
</code></pre></div></div>

<p><img src="/blog/images/p2p_video_streaming_25_1.png" alt="png" /></p>

<p>It is clear from the left barplot that the different internet service providers do not act the same way in the p2p. For instance, rougly 80% of the “Datch Telecam” users are not connected but are registered in the p2p. In contrast, only a neglectable number of users using “BTP” are registered but not connected. <br /><br />
On the other hand, even if the variance is not the same, also browsers do not behave in the same way. Some browsers, more than others, allow users to be registered in the p2p and yet not connected.<br /><br />
The fact that a user is not connected but is part of the p2p creates an issue that will be discussed in recommendation part.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_p2p</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">sn</span><span class="p">):</span>
    <span class="s">'''
    plots the p2p and cdn for a given stream on a given sliding window
    dataset : the preprocessed dataset
    width : the width of the window
    sn : the stream
    '''</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="s">'#stream'</span><span class="p">]</span> <span class="o">==</span> <span class="n">sn</span><span class="p">]</span>
    <span class="n">values_p2p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">values_cdn</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">number_of_batches</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">//</span> <span class="n">width</span>
    
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_batches</span><span class="p">):</span>
        <span class="n">mean_p2p</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">width</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">width</span><span class="p">][</span><span class="s">'% p2p'</span><span class="p">])</span>
        <span class="n">values_p2p</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_p2p</span><span class="p">)</span>
        <span class="n">values_cdn</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">mean_p2p</span><span class="p">)</span>
        
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values_p2p</span><span class="p">,</span> <span class="n">values_cdn</span><span class="p">]</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">number_of_batches</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">stackplot</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">'p2p'</span><span class="p">,</span><span class="s">'cdn'</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s">'sandybrown'</span><span class="p">,</span> <span class="s">'dodgerblue'</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'P2p and cdn over a window of {} for stream {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">sn</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper left'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Percentage'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'k'</span><span class="p">)</span>
    
    
    <span class="n">fig</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">plot_p2p</span><span class="p">(</span><span class="n">data_preprocessed</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">st</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/blog/images/p2p_video_streaming_28_0.png" alt="png" /></p>

<p><img src="/blog/images/p2p_video_streaming_28_1.png" alt="png" /></p>

<p><img src="/blog/images/p2p_video_streaming_28_2.png" alt="png" /></p>

<p><img src="/blog/images/p2p_video_streaming_28_3.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">plot_p2p</span><span class="p">(</span><span class="n">data_preprocessed</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">st</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/blog/images/p2p_video_streaming_29_0.png" alt="png" /></p>

<p><img src="/blog/images/p2p_video_streaming_29_1.png" alt="png" /></p>

<p><img src="/blog/images/p2p_video_streaming_29_2.png" alt="png" /></p>

<p><img src="/blog/images/p2p_video_streaming_29_3.png" alt="png" /></p>

<p><img src="/blog/images/p2p_video_streaming_29_4.png" alt="png" /></p>

<p>The previous 9 subplots, corresponding to the 9 streams present in the dataset, show that percentage of the amount of retrieval from p2p and cdn for each stream. The streams clearly do not behave the same way : for some, the proportion of retrieval from the p2p is comparable and even higher that the amount of retrieval from a cdn. However, for others (for instance stream 3 and 4), the retrieval of the stream from cdn is much more important than that of p2p. Only few users are sharing the stream in the p2p whereas all the others are getting it directly from the cdn.</p>

<p><a id="deux"></a></p>
<h2 id="recommendation-for-the-service">Recommendation for the Service</h2>

<p>The main goal of the streaming providors is to allow the users to watch high-quality videos without any buffering. The P2p architecture was designed to ensure this goal : all the users play the double role of servers and clients. In this scheme, a user can get the streaming from another user which is near him geographically. <strong>This highly reduces the bandwidth cost</strong> of getting the stream directly from the cdn. However, there are many bottlenecks when using p2p. The exploratory data analysis that I did above shows some issues that need to be tackled in order to provide a better service. The two main issues seen are : <br /><br />
     + Many users are registered in the dataset but actually not connected.
     + Many users are watching the same stream, but only few are being in a p2p where the majority is getting the video directly from cdn.
The first issue can be seen as an outlier detection problem : the users that are not connected are “bad” users in a sense that they create noise and disturb the p2p scheme. In fact, in a p2p scheme, some connected users may try to connect to those “not connected” users but will not retrieve anything from them. This is a loss of time and can be costly in term of bandwidth. Therefore, one obvious recommendation would be to detect them and discard them. Nevertheless, we may ask ourselves : how do these outliers emerge ? In fact, there could be many possible anserws. For example, as we saw from the plots, some Internet Service Providors can be bad and not really adapted to the p2p scheme since they register the users in the scheme while they are not actually connected. One can think of contacting these providors to find the actual source of this issue, or even try to adapt the p2p to those providors as well. Before getting to the second issue, I want to point that outlier detection would probably lead to false positive discovery. One ought to reduce the false positives in order not to loose the users <br /><br /></p>

<p>The second issue concerns the users that are connected, watching the same video as others but not retrieving anything from p2p. Those kind of users naturally exist, since they can be the “first viewers” of the stream and thereof it is normal that there is no one they can retrieve the video from. Yet, when their number grow, this can be considered as an issue : they are not actually benefiting from the p2p. I am not sure, but I think this can be caused by the fact that the circumstances in which they are are not adapted for p2p : there are no other users geographically nearby, or maybe they somehow blocked the p2p retrieval for some reason. An other possible reason is that the stream they are watching is itself blocking a part of the p2p. So an idea can be to contact these stream providors and offer them a different javascript code to adapt with p2p. If the problem is geographical, we can may be think of installing a distrubted network in that area so that to facilicitate the retrieval of the stream.</p>

<p>This is the first time ever I had the chance to work on a streaming service. I think there are many assets and issues that can be tackled. If well dealt with, the experience of users would be better since he will have access to high quality and fast streaming with no buffering. This is really important since streaming is the new trend for watching videos. <br /><br />
I believe that if I had more time, I could have done some other things with this data in order to emphasize on the cited bottlenecks. For example, I would formulate a machine learning problem of outlier detection. I would consider the p2p feature as a target feature and try to fit a function that estimates it from a training sample. Then, I would predict this target variable and see which users have a low / zero p2p retrieval value. These users would be considered as outliers and would be eliminated from the scheme. Then I would redo a plot of the percentage of data retrieval from p2p for the remaining users and see its effect. I think that this percentage will grow and therefor the users will benefit more from the p2p scheme.</p>

    </div><!-- .post-content -->
    <div class="post-share">
      <span>Share:</span>
      <a target="_blank"
        href="https://twitter.com/intent/tweet?text=From%20CDN%20to%20P2P:%20a%20Brief%20Dataset%20Analysis%20for%20Video%20Streaming&amp;url=http://localhost:4000/blog/from-cdn-to-p2p" rel="noopener">Twitter</a>
      <a target="_blank"
        href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/blog/from-cdn-to-p2p&amp;t=From%20CDN%20to%20P2P:%20a%20Brief%20Dataset%20Analysis%20for%20Video%20Streaming" rel="noopener">Facebook</a>
    </div><!-- .share-post -->
    <div class="author-box">
      
      <div class="author-avatar" style="background-image: url('images/author.png')"><span class="screen-reader-text">Ahmed Akakzia's Picture</span></div>
      
      <div class="author-details">
        <h2 class="author-title">About Ahmed Akakzia</h2>
        <div class="author-bio"><p>Ahmed is a final year PhD candidate, passionate about artificial intelligence</p>
</div>
        
        <span class="author-location">Paris, France</span>
        
        
      </div><!-- .author-details -->
    </div><!-- .author-box -->
  </article><!-- .post -->

  
    <div class="comments-area">
  <div class="comments-inner">
    <h2 class="comments-title">Comments</h2>
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
        Disqus</a>.</noscript>
  </div><!-- .comments-inner -->
</div><!-- .comments-area -->

<script type="text/javascript">
  var disqus_shortname = 'justgoodthemes';
  var disqus_developer = 0;
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
  
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</main><!-- .main-content -->
      <footer class="site-footer">
  <div class="offsite-links">
    
      
<a href="https://twitter.com/aakakzia" target="_blank" rel="noopener">
  <span class="fa-twitter" aria-hidden="true"></span>
  <span class="screen-reader-text">Twitter</span>
</a>

<a href="https://github.com/akakzia" target="_blank" rel="noopener">
  <span class="fa-github" aria-hidden="true"></span>
  <span class="screen-reader-text">GitHub</span>
</a>

<a href="https://www.linkedin.com/in/ahmed-akakzia/" target="_blank" rel="noopener">
  <span class="fa-linkedin" aria-hidden="true"></span>
  <span class="screen-reader-text">LinkedIn</span>
</a>

    
  </div><!-- .offsite-links -->
  <div class="footer-bottom">
    <div class="site-info">
      <p>© 2022 Ahmed Akakzia. Theme customized from <a href="https://www.justgoodthemes.com">JustGoodThemes</a>.</p>

    </div><!-- .site-info -->
    <a href="#page" id="back-to-top" class="back-to-top"><span class="screen-reader-text">Back to the top </span>&#8593;</a>
  </div><!-- .footer-bottom -->
</footer><!-- .site-footer -->

    </div><!-- .inner -->
  </div><!-- .site -->

  <!-- Scripts -->
  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>
  
  <script src="/blog/assets/js/plugins.js"></script>
  <script src="/blog/assets/js/custom.js"></script>

</body>
</html>