<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RAMP on Predictive Maintenance for Aircraft Engines</title>
  <meta name="description" content="A brief study of two different video streaming techniques.">
  <link rel="canonical" href="http://localhost:4000/blog/aircraft-starting-kit">
  <link rel="alternate" type="application/rss+xml" title="Ahmed Akakzia Feed"
    href="http://localhost:4000/blog/feed.xml">
  
  <link rel="shortcut icon" href="/blog/images/tabicon.png" type="image/png" />
  
  <!-- Styles -->
  <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%7CNoto+Serif:400,400i,700,700i&display=swap" rel="stylesheet">
  <link href="/blog/assets/css/style.css" rel="stylesheet">
</head>
<body>

  <div id="page" class="site">
    <div class="inner">
      <header class="site-header">
  
  <p class="site-title"><a class="logo-text" href="/blog/">Ahmed Akakzia</a></p>
  
  <nav class="site-navigation">
    <div class="site-navigation-wrap">
      <h2 class="screen-reader-text">Main navigation</h2>
      <ul class="menu">
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/index">Scientific Lab</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/publications">Publications</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/about">About</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/blog/contact">Contact</a>
        </li>
        
      </ul><!-- .menu -->
      <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span
          class="icon-close" aria-hidden="true"></span></button>
    </div><!-- .site-navigation-wrap -->
  </nav><!-- .site-navigation -->
  <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
</header>


      <main class="main-content fadeInDown delay_075s">

  <article class="post">
    <header class="post-header">
      <time class="post-date" datetime="2019-01-14">January 14, 2019</time>
      <h1 class="post-title">RAMP on Predictive Maintenance for Aircraft Engines</h1>
      <div class="post-meta">
        By <span class="post-author">Ahmed Akakzia</span>
      </div><!-- .post-meta -->
      
      <figure class="post-thumbnail image-card width-wide">
        <img src="/blog/images/aircraft.png" alt="RAMP on Predictive Maintenance for Aircraft Engines">
      </figure><!-- .post-thumbnail -->
      
    </header><!-- .post-header -->
    <div class="post-content">
      <blockquote>
  <p>Airlines seem to be successful businesses with strong management. Nonetheless, they literally bear high costs due to delays and cancellations that includes expenses on maintenance and compensations to travelers stuck in airports. Besides, they suffer from a non neglectable probability of failing on-flight accidents which can lead to disasters.</p>
</blockquote>

<!--more-->

<p>With nearly 30 percent of the total delay time caused by unplanned maintenance and at least 200 accident per year (including fatal accidents) , predictive analytics applied to fleet technical support is a reasonable solution. Predictive maintenance solutions are used to better manage data from aircraft health monitoring sensors. Knowing an aircraft’s current technical condition through alerts, notifications, and reports, employees can spot issues pointing at possible malfunction and replace parts proactively. Executives and team leads, in turn, can receive updates on maintenance operations, get data on tool and part inventory, and expenses via dashboards. With applied predictive maintenance, an airline can reduce expenses connected with expedited transportation of parts, overtime compensation for crews, and unplanned maintenance. If a technical problem did occur, maintenance teams could react to it faster with workflow organization software. The solution consists of analyzing data and metadata regarding detected maintenance activity. It helps engineers quickly evaluate a situation, for instance, to find out if this failure happened for the first time; if not, what can be done to fix it and how much time did it take to solve it previous times.</p>

<div style="text-align: left;">
<table style="width:100%; background-color:transparent;">
  <tr style="background-color:transparent;">
    <td style="background-color:transparent;"><img src="http://project.inria.fr/saclaycds/files/2017/02/logoUPSayPlusCDS_990.png" width="70%" /></td>
  </tr>
</table> 
</div>

<p><em>Salma JERIDI, Aymen DABGHI, Aymen MTIBAA, Ahmed AKAKZIA</em></p>

<div>
<table style="width:100%; background-color:transparent;">
  <tr style="background-color:transparent;">
    <td style="background-color:transparent;"><img src="https://1l0044267psh26mr7fa57m09-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/opinion.jpg" width="100%" /></td>
  </tr>
</table> 
</div>

<p><a href="#un">1. Prognostics and Health Management<br /></a>
<a href="#deux">2. Business case<br /></a>
<a href="#deux_un">2.1 Introduction<br /></a>
<a href="#deux_deux">2.2 Business Model<br /></a>
<a href="#trois">3. System and Damage Propoagation Modeling<br /></a>
<a href="#trois_un">3.1 System Modeling<br /></a>
<a href="#trois_deux">3.2 Damage Propoagation Modeling<br /></a>
<a href="#quatre">4. Data for the Challenge<br /></a>
<a href="#cinq">5. Exploratory Data Analysis<br /></a>
<a href="#six">6. Features Extraction<br /></a>
<a href="#sept">7. Classification model<br /></a>
<a href="#huit">8. Evaluation<br /></a>
<a href="#neuf">9. Submitting to the online challenge<br /></a></p>

<p><a id="un"></a></p>
<h1 id="1-prognostics-and-health-management-phm">1. Prognostics and Health Management (PHM)</h1>

<p>Prognostics and health management <em>(PHM)</em> is an engineering process of failure prevention and predicting reliability and remaining useful lifetime <em>(RUL)</em>. It has become an important component of many engineering systems and products since it is very crucial to every industry to to detect anomalies, malfunctions and failures before they can damage the whole environment, including the system and the users, and may cause high costs for repairs on un-scheduled maintenance. Inspite of its main objective which is to ensure safety for users, it provides state of the heath of the components and systems which can create a scheduled list to program maintenance before damage. These maintenance tasks become therefore evidence-based scheduled There are two main categories of applications of PHM :</p>

<ul>
  <li><strong>Off-line PHM</strong> : It concerns systems where safety is not critical and the ratio of failures is very small.</li>
  <li><strong>Real-time PHM</strong> : It concerns systems where safety is critical and that demand on-board monitoring capability.</li>
</ul>

<p>There are two approaches that help define the health of a system as the extent of deviation or degradation from its expected typical operating performance which has to be determined accurately to prevent the failures : <strong>Data-driven</strong> and <strong>Model-driven</strong>. The former, as its name indicates, is based on data collection via real capturing or simulations based on theoretically-proved models. The latter is rather based on models that describe the system functionalities and specific knowledge.<br /><br /></p>

<div>
<table style="width:100%; background-color:transparent;">
  <tr style="background-color:transparent;">
    <td style="background-color:transparent;"><img src="http://faculty.unist.ac.kr/reliability/wp-content/uploads/sites/357/2017/10/prognostics-and-health.png" width="70%" /></td>
  </tr>
</table> 
</div>

<p><strong>In this challenge</strong>, we would rather focus on the data-driven approach which uses monitored and historical data to learn the systems behaviours and perform prognostics. It is suitable for systems which are complex and with behaviours that cannot be assessed and deribed from first principles. It uses many algorithms that are quicker to implement and which are computationally more efficient to run compared with other techniques. The data is usually obtained via sensors. One problem of this approach is that the confidence level in the predictions depends on the available historical and empirical data. Besides, it requires some threshold values to be put by the operator which can sometimes be non-trivial.<br />
Most efforts are focusing on data-driven approaches reflects the desire to harvest low-hanging fruit as compared to model-based approaches. Yet, it can be difficult to gain an access to statistically significant amounts of run-to-failure data and common metrics that allow a comparison between different approaches. Thus, a system model had been established in order to generate run-to failure data that can be utilized to develop, train and test prognostic algorithms. However, before entering into details of system modeling, let’s start by introducing the business case we will be considereing for this challenge.</p>

<p><a id="deux"></a></p>
<h1 id="2-business-case-">2. Business Case :</h1>
<p><a id="deux_un"></a></p>
<h2 id="21-introduction-">2.1 Introduction :</h2>

<p><strong>Airlines</strong> seem to be successful businesses with strong management. Nonetheless, they literally bear high costs due to delays and cancellations that includes expenses on maintenance and compensations to travelers stuck in airports. Besides, they suffer from a non neglectable probability of failing on-flight accidents which can lead to disasters. With nearly 30 percent of the total delay time caused by unplanned maintenance and at least 200 accident per year (including fatal accidents) , predictive analytics applied to fleet technical support is a reasonable solution.<br /><br />
Predictive maintenance solutions are used to better manage data from aircraft health monitoring sensors. Knowing an aircraft’s current technical condition through alerts, notifications, and reports, employees can spot issues pointing at possible malfunction and replace parts proactively. Executives and team leads, in turn, can receive updates on maintenance operations, get data on tool and part inventory, and expenses via dashboards.<br /><br />
With applied predictive maintenance, an airline can reduce expenses connected with expedited transportation of parts, overtime compensation for crews, and unplanned maintenance. If a technical problem did occur, maintenance teams could react to it faster with workflow organization software. The solution consists of analyzing data and metadata regarding detected maintenance activity. It helps engineers quickly evaluate a situation, for instance, to find out if this failure happened for the first time; if not, what can be done to fix it and how much time did it take to solve it previous times.<br /><br />
<strong>Read further :</strong> https://www.forbes.com/sites/oliverwyman/2017/06/16/the-data-science-revolution-transforming-aviation/#6e2663227f6c</p>

<p><a id="deux_deux"> </a></p>

<h2 id="22-business-model-">2.2 Business Model :</h2>

<h3 id="221--business-problem-">2.2.1 : Business Problem :</h3>

<p>On the first hand, being ranked second after pilot error, aircraft’s system failure is still one of the five most common reasons for accidents. Equipment failures still account for around 20% of aircraft losses, despite improvements in design and manufacturing quality. While engines are significantly more reliable today than they were half a century ago, they still occasionally suffer catastrophic failures.<br /><br /></p>

<p>Sometimes, new technologies introduce new types of failure. In the 1950s, for example, the introduction of high-flying, pressurised jet aircraft introduced an entirely new hazard – metal fatigue brought on by the hull’s pressurisation cycle. Several high-profile disasters caused by this problem led to the withdrawal of the de Havilland Comet aircraft model, pending design changes.<br /><br /></p>

<p>On the other hand, if it is discovered that there is a maintenance issue with your aircraft, the flight will not embark until the issue has been fully addressed. Sometimes, these issues are being worked on even as passengers board the plane, meaning the delay the passenger experiences might take place entirely on the tarmac. Other times, in the case of larger issues, your airline might make the call to switch planes entirely for the safety of everyone involved. Thus, this would cost a lot of money for the airline company to handle.<br /><br /></p>

<p>On-flight accidents and delays cause enormous costs for the airlines each year. Therefore, this issue should be handled.</p>

<h3 id="222-our-solution-">2.2.2: Our solution :</h3>

<p>First, we have to understand two main concepts: airliners are complex mechanical wonders, and second, their maintenance and operation is very strictly and minutely regulated–and documented. This second point is essential to the aviation regulatory standard upheld by all major airlines, even though such detail must be correctly, diligently accomplished. <br /><br /></p>

<p>Our solution would be to use a data-driven approach in order to schedule the different maintenance tasks in advance. In consists of making use of the different sensors and telemetry available, which depend on the different conditions and modes to predict the order of priority for each engine. In this way, the client would be able to know which engines need to go through maintenance tasks immediately, and which can still wait.<br /><br /></p>

<p>Since we talked about the client,  it can be an airline company trying to utilize historical data of equipment sensors to make data-driven decisions on its maintenance planning. Based on this analysis, the company will be able to estimate engine’s order of priority and optimize its maintenance operations accordingly.</p>

<h3 id="223--predictive-maintenance-task-">2.2.3 : Predictive maintenance task :</h3>
<p>As mentionned previously, reliably estimating remaining life holds the promise for considerable cost savings. In fact, that allows us to avoid unscheduled maintenance and to increase equipment usage, and unsures the operational safety improvements.</p>

<p>Some studies focus on predicting the Remaining Useful Life (RUL) of the engine of a part and its components, or the exact Time to Failure (TTF). For safety purpose, and considering the error of the predictive model, companies may define a safety threshold ie : a number of cycles that they add to the prediction made by the regressor. This fact makes the alternative of predicting if an asset will fail in different time windows relevant. We formulate then as a Multi-class classification problem and we define 4 four Time to Failure windows (4 classes) :</p>

<ul>
  <li>
    <p><strong> Class 0 : </strong>Very urgent maintenance : <strong> 0 to 10 cycles </strong> remaining before failure.</p>
  </li>
  <li>
    <p><strong> Class 1 : </strong> Aircraft maintenance periodic checks need to be deep and more detailed : <strong> 11 to 30 cycles </strong> remaining before failure.</p>
  </li>
  <li>
    <p><strong> Class 2 : </strong> Confident system : We can plan from this period the future maintenance date and provide the needed equipments :<strong> 31 to 100  cycles </strong> remaining before failure.</p>
  </li>
  <li>
    <p><strong> Class 3: </strong>Very confident system : Only periodic checks are needed : <strong>more than 101cycles </strong>remaining before failure.</p>
  </li>
</ul>

<p>We set the thresholds based on two key ideas of the predective maintenance : We want to predict the optimal time for maintenance by :</p>

<ol>
  <li>
    <p>Minimizing the risk of unexpected failure.</p>
  </li>
  <li>
    <p>Minimizing the cost of early and useless maintenance.</p>
  </li>
</ol>

<h3 id="224--business-metrics-">2.2.4 : Business metrics :</h3>

<p>In our context, since the key aspect is to avoid failures, it is generally desirable to predict early as compared to predicting late. However, early predictions may also involve significant economic burden. We need then to choose a metric that heavely penalizes late predictions and takes of course into account the early prediction. To do so, we propose to combine two metrics :</p>

<h4 id="macro-averaged-f1-score-">Macro-averaged F1-score :</h4>

<p>In this score, we need to define the weighted macro precision and recall score. We define the weights w.r.t to the previous condition. In fact,</p>

<ol>
  <li>Assuming we have a One-vs-All (OvA) classifier, we calculate for each class (j) the corresponding precision and recall score :</li>
</ol>

\[P_j = \frac{TP_j}{TP_j+FP_j} \quad \quad \quad R_j = \frac{TP_j}{TP_j+FN_j}\]

<ol>
  <li>We average the performances of each individual class using a weight vector. In fact, making a late prediction for an engine having class 0 in the true labels is very dangerous. So, we need to avoid as much as possible the False Negative prediction for elements of the first class. The less is the true maintenance urgency, the more we can tolerate the FN rate. For this reason, we define the weighted Recall rate by :</li>
</ol>

\[R = \sum_{i=1}^{4} w_i R_i, \quad \quad \quad w = [0.5, 0.3, 0.1, 0.1]\]

<ol>
  <li>Similarly, falsely predicting that an aircraft is in class 3 is a late prediction and can cause damages specially if the true label is urgent maintenance. We can tolerate a bit more the case of class 2 because in some cases we can have an early prediction, but we still aim to penalize this kind of prediction. To do so, we define the weighted Precision as following :</li>
</ol>

\[P = \sum_{i=1}^{4} w_i P_i, \quad \quad \quad w = [0.1, 0.2, 0.3, 0.4]\]

<ol>
  <li>Finally, using the precision &amp; recall calculated previoulsly, we define the macro-averaged F1-score by :</li>
</ol>

\[F1 = \frac{2 * P * R}{P+R}\]

<h4 id="multi-class-logarithmic-loss-function-">Multi-class logarithmic loss function :</h4>

<p>We introduce the log loss function for our multicass problem :</p>

\[LogLoss = − \frac{1}{N}\sum_i^N \sum_j^M y_{ij} \log(p_{ij}))\]

<p>where N is the number of instances, M is the number of different labels, $y_{ij}$ is the binary variable with the expected labels and $p_{ij}$ is the classificiation probability output by the classifier for the i-instance and the j-label.</p>

<h4 id="mixed-score">Mixed score:</h4>

<p>We define the final score function that we aim to minimize by :</p>

\[L = LogLoss + (1 - F1_{score})\]

<p><a id="trois"></a></p>
<h1 id="3-system-and-damage-propagation-modeling-">3. System and Damage Propagation Modeling :</h1>

<p>As mentionned in the introduction, data-driven prognostics faces the perennial challenge of the lack of run-to-failure data sets. In most cases realworld, it is time consuming and expensive to have such a data. In other cases, it’s is not even feasible. For example, an airlaine company cannot afford to wait for an engine failure in order to keep the failure exact date. Instead, they perform model/data driven maintenance to avoid the failures.</p>

<p>In order to face the lack of PHM data, a group of scientist in the U.S. National Aeronautics and Space Administration (NASA) worked on generating run-to-failure data that can then be utilized to develop, train, and test prognostic algorithms. In our challenge, we are going to use this generated data in order to train a robust model that can be used on real sensors data.</p>

<p>First, let’s introduce the two main concept of data generation.</p>

<p><a id="trois_un"></a></p>
<h2 id="31-system-modeling">3.1 System modeling</h2>

<p>As the goal is to track and to predict the progression of damage in aircraft, the group of scienctist worked first on the simulation of a suitable system model that allows input variations of health related parameters and recording of the resulting output sensor measurements. To do so, they used C-MAPSS (Commercial Modular Aero Propulsion System Simulation) that allow the user to enter specific values of his/her own choice regarding operational profile, closed-loop controllers, environmental conditions, etc, and outputs a simulation of an engine model. A simplified diagram of engine simulated in C-MAPSS and a layout showing various modules and their connections as modeled in the simulation are shown in the following figures :</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Simplified diagram of engine simulated in C-MAPSS</th>
      <th style="text-align: center">Various modules and their connections as modeled in the simulation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://raw.githubusercontent.com/akakzia/aircraft_engine_predictive_maintenance/master/image/engine_diagram.PNG" alt="" /></td>
      <td style="text-align: center"><img src="https://raw.githubusercontent.com/akakzia/aircraft_engine_predictive_maintenance/master/image/modules_layout.PNG" alt="" /></td>
    </tr>
  </tbody>
</table>

<p>To simulate various degradation scenarios in any of the five rotating components of the simulated engine, C-MAPSS inputs the aircraft configuration. For example, to simulate HPC (High-Pressure Compressor) degradation, C-MAPSS requires the HPC flow and efficiency modifiers. The outputs include various sensor response surfaces. A total of 21 variables out
of 58 different outputs available from the model were used in this challenge.</p>

<p>As an example of sensor response, we have :</p>

<ul>
  <li>Total temperature at HPC outlet</li>
  <li>Total temperature at LPT outlet</li>
  <li>Pressure at fan inlet</li>
  <li>Total pressure in bypass-duct</li>
  <li>Total pressure at HPC outlet</li>
  <li>Physical fan speed</li>
  <li>Physical core speed, …</li>
</ul>

<p><a id="trois_deux"></a></p>
<h2 id="32-damage-propagation-modeling">3.2 Damage propagation modeling</h2>

<p>Having decided on the system model, the next step is to model the propagation of damage. The purpose here is to find a model-based method to generate the Time-to-failure (ttf) given the sensors data. In litterature, many degradation models have been proposed. <strong>As an example</strong>, The Arrhenius model has been used for a variety of failure mechanisms. The operative equation is:
\(t_f = A * e^{\frac{\Delta H}{kT}}\)</p>

<p>With :</p>
<ul>
  <li>$t_f$ is the time to failure,</li>
  <li>T is the temperature at the point when the failure process takes place,</li>
  <li>k is Boltzmann’s constant,</li>
  <li>A is a scaling factor, and</li>
  <li>$\Delta H$ is the activation energy.</li>
</ul>

<p>In our case, For the purpose of a physics-inspired data-generation approach, we assume a generalized <strong>equation for wear</strong> which ignores micro-level processes but retains macro-level degradation characteristics. In addition to this propagation model, two important issues have been considered :</p>

<h3 id="321-initial-wear">3.2.1 Initial Wear</h3>

<p>Initial wear can occur due to manufacturing inefficiencies and are commonly observed in real systems. In the simulation, the degree of initial wear that an engine might experience with progressive usage was implemented following the calculations made by 
Chatterjee and Litt (see S. Chatterjee and J. Litt, “Online Model Parameter Estimation of Jet Engine Degradation for Autonomous Propulsion Control, “NASA, Technical Manual TM2003-212608, 2003. for more details)</p>

<h3 id="322-effects-of-between-flight-maintenance">3.2.2 Effects of between-flight maintenance</h3>

<p>The effects of between-flight maintenance have not been explicitly modeled but have been incorporated as the process noise. Since there was no real data available to characterize true noise levels, simplistic normal noise distributions were assumed based on information available from the literature. Finally, To make the signal noise non-trivial, mixture distributions were used.</p>

<p><a id="quatre"></a></p>

<h1 id="4-data-for-the-challenge">4. Data for the challenge</h1>

<p>During this challenge, we are going to use the NASA’s public data set, result of Engine degradation simulation described previously. Four different sets were simulated under different combinations of operational conditions and fault modes (original data available here : https://ti.arc.nasa.gov/tech/dash/groups/pcoe/prognostic-data-repository/?fbclid=IwAR2ec11zAXo5KH5PcJO0axppSlajScvSrUL17xxbSqUiQ7YpVie31CCSw4s#turbofan)</p>

<p>For our case, we restrict our study to the combination of two data sets simulated under those conditions :</p>

<ul>
  <li>Fault Modes : HPC and/or Fan module Degradation</li>
  <li>Simulation under sea level condition.</li>
</ul>

<p>Data sets consists of multiple multivariate time series(unit of time is one cycle). Each data set is further divided into training and test subsets. Each time series is from a different engine, i.e, the data can be considered to be from a fleet of engines of the same type.</p>

<p>The engine is operating normally at the start of each time series, and develops a fault at some point during the series. In the training set, the fault grows in magnitude until system failure. In the test set, the time series ends some time prior to system failure. To conclude, the available data is the following :</p>

<ul>
  <li>Training Data: The aircraft engine run-to-failure data.</li>
  <li>Test Data: The aircraft engine operating data without failure events recorded.</li>
  <li>Ground Truth Data: The true remaining cycles (True TTF) for each engine in the testing data.</li>
</ul>

<p>In order to fit the data to the problem’s need, we brought the following modifications:</p>

<ul>
  <li>
    <p>As the training data was not labeled and knowing the system failure cycle, we started by calculating the Time To Failure (TTF) of each observation and then we assigned them to the corresponding classes.</p>
  </li>
  <li>
    <p>The true TTF available in the ground truth data correspond to the last observation of each engine(which is not its failure point). So in order to have more data for testing, we used these true TTF to generate the number of remaining cycles for the rest of the observations.</p>
  </li>
</ul>

<hr />

<h2 id="import-libraries">Import libraries</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">problem</span> <span class="kn">import</span> <span class="n">get_train_data</span><span class="p">,</span>  <span class="n">get_test_data</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span> <span class="p">,</span> <span class="n">auc</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span><span class="n">recall_score</span><span class="p">,</span><span class="n">log_loss</span><span class="p">,</span> <span class="n">roc_curve</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">label_binarize</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interp</span>
<span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

</code></pre></div></div>

<h2 id="loading-the-data">Loading the data</h2>
<p>We start by inspecting the training data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load train data
</span><span class="n">X_train</span> <span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">get_train_data</span><span class="p">()</span>
<span class="n">X_train</span><span class="p">.</span><span class="n">shape</span> <span class="p">,</span> <span class="n">y_train</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>((45351, 26), (45351,))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table style="width:10;" border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Cycle</th>
      <th>op_set_1</th>
      <th>op_set_2</th>
      <th>op_set_3</th>
      <th>s1</th>
      <th>s2</th>
      <th>...</th>
      <th>s15</th>
      <th>s16</th>
      <th>s17</th>
      <th>s18</th>
      <th>s19</th>
      <th>s20</th>
      <th>s21</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>-0.0007</td>
      <td>-0.0004</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>641.82</td>
      <td>...</td>
      <td>8.4195</td>
      <td>0.03</td>
      <td>392</td>
      <td>2388</td>
      <td>100.0</td>
      <td>39.06</td>
      <td>23.4190</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>0.0019</td>
      <td>-0.0003</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>642.15</td>
      <td>...</td>
      <td>8.4318</td>
      <td>0.03</td>
      <td>392</td>
      <td>2388</td>
      <td>100.0</td>
      <td>39.00</td>
      <td>23.4236</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>-0.0043</td>
      <td>0.0003</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>642.35</td>
      <td>...</td>
      <td>8.4178</td>
      <td>0.03</td>
      <td>390</td>
      <td>2388</td>
      <td>100.0</td>
      <td>38.95</td>
      <td>23.3442</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>4</td>
      <td>0.0007</td>
      <td>0.0000</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>642.35</td>
      <td>...</td>
      <td>8.3682</td>
      <td>0.03</td>
      <td>392</td>
      <td>2388</td>
      <td>100.0</td>
      <td>38.88</td>
      <td>23.3739</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
      <td>-0.0019</td>
      <td>-0.0002</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>642.37</td>
      <td>...</td>
      <td>8.4294</td>
      <td>0.03</td>
      <td>393</td>
      <td>2388</td>
      <td>100.0</td>
      <td>38.90</td>
      <td>23.4044</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 20 columns</p>
</div>

<p>The data consist of 45351 observations and 26 features. 
Each row is a snapshot of data taken during a single operational cycle, each column is a different variable. The columns correspond to:</p>

<ul>
  <li>
    <p>1) Unit number or ID of the engine ( 200 unique IDs)</p>
  </li>
  <li>
    <p>2) Time in cycles</p>
  </li>
  <li>
    <p>3) to 5) Operational settings 1 to 3</p>
  </li>
  <li>
    <p>6) to 26) Sensor measurements 1 to 21</p>
  </li>
</ul>

<p>These measurements include various sensor response surfaces and operability margins :</p>

<ul>
  <li>s1 : Total temperature at fan inlet</li>
  <li>s2: Total temperature at LPC outlet</li>
  <li>s3 : Total temperature at HPC (High-Pressure Compressor) outlet</li>
  <li>s4: Total temperature at LPT outlet</li>
  <li>s5: Pressure at fan inlet</li>
  <li>s6 : Total pressure in bypass-duct</li>
  <li>s7 :Total pressure at HPC outlet</li>
  <li>s8: Physical fan speed</li>
  <li>s9 :Physical core speed</li>
  <li>s10: Engine pressure ratio (P50/P2)</li>
  <li>s11: Static pressure at HPC outlet</li>
  <li>s12: Ratio of fuel flow to Ps30</li>
  <li>s13: Corrected fan speed</li>
  <li>s14: Corrected core speed</li>
  <li>s15: Bypass Ratio</li>
  <li>s16: Burner fuel-air ratio</li>
  <li>s17: Bleed Enthalpy</li>
  <li>s18: Demanded fan speed</li>
  <li>s19: Demanded corrected fan speed</li>
  <li>s20: HPT coolant bleed</li>
  <li>s21: LPT coolant bleed</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 45351 entries, 0 to 45350
Data columns (total 26 columns):
ID          45351 non-null int64
Cycle       45351 non-null int64
op_set_1    45351 non-null float64
op_set_2    45351 non-null float64
op_set_3    45351 non-null float64
s1          45351 non-null float64
s2          45351 non-null float64
s3          45351 non-null float64
s4          45351 non-null float64
s5          45351 non-null float64
s6          45351 non-null float64
s7          45351 non-null float64
s8          45351 non-null float64
s9          45351 non-null float64
s10         45351 non-null float64
s11         45351 non-null float64
s12         45351 non-null float64
s13         45351 non-null float64
s14         45351 non-null float64
s15         45351 non-null float64
s16         45351 non-null float64
s17         45351 non-null int64
s18         45351 non-null int64
s19         45351 non-null float64
s20         45351 non-null float64
s21         45351 non-null float64
dtypes: float64(22), int64(4)
memory usage: 9.0 MB
</code></pre></div></div>

<p>$\rightarrow$ <strong>There is no missing values to deal with. </strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Cycle</th>
      <th>op_set_1</th>
      <th>op_set_2</th>
      <th>op_set_3</th>
      <th>s1</th>
      <th>s2</th>
      <th>...</th>
      <th>s18</th>
      <th>s19</th>
      <th>s20</th>
      <th>s21</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>45351</td>
      <td>45351</td>
      <td>45351</td>
      <td>45351</td>
      <td>45351.0</td>
      <td>4.535100e+04</td>
      <td>45351</td>
      <td>...</td>
      <td>45351.0</td>
      <td>45351.0</td>
      <td>45351</td>
      <td>45351</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>104.447796</td>
      <td>125.307049</td>
      <td>-0.000017</td>
      <td>0.000004</td>
      <td>100.0</td>
      <td>5.186700e+02</td>
      <td>642.559339</td>
      <td>...</td>
      <td>2388.0</td>
      <td>100.0</td>
      <td>38.910178</td>
      <td>23.346022</td>
    </tr>
    <tr>
      <th>std</th>
      <td>56.544862</td>
      <td>87.813757</td>
      <td>0.002191</td>
      <td>0.000294</td>
      <td>0.0</td>
      <td>4.637337e-10</td>
      <td>0.524596</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.236600</td>
      <td>0.141834</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1</td>
      <td>1</td>
      <td>-0.008700</td>
      <td>-0.000600</td>
      <td>100.0</td>
      <td>5.186700e+02</td>
      <td>640.840000</td>
      <td>...</td>
      <td>2388.0</td>
      <td>100.0</td>
      <td>38.140000</td>
      <td>22.872600</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>57</td>
      <td>57</td>
      <td>-0.001500</td>
      <td>-0.000200</td>
      <td>100.0</td>
      <td>5.186700e+02</td>
      <td>642.180000</td>
      <td>...</td>
      <td>2388.0</td>
      <td>100.0</td>
      <td>38.760000</td>
      <td>23.254500</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>108</td>
      <td>114</td>
      <td>0</td>
      <td>0</td>
      <td>100.0</td>
      <td>5.186700e+02</td>
      <td>642.520000</td>
      <td>...</td>
      <td>2388.0</td>
      <td>100.0</td>
      <td>38.900000</td>
      <td>23.342400</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>152</td>
      <td>174</td>
      <td>0.001500</td>
      <td>0.000300</td>
      <td>100.0</td>
      <td>5.186700e+02</td>
      <td>642.900000</td>
      <td>...</td>
      <td>2388.0</td>
      <td>100.0</td>
      <td>39.050000</td>
      <td>23.430100</td>
    </tr>
    <tr>
      <th>max</th>
      <td>200</td>
      <td>525</td>
      <td>0.008700</td>
      <td>0.000700</td>
      <td>100.0</td>
      <td>5.186700e+02</td>
      <td>645.110000</td>
      <td>...</td>
      <td>2388.0</td>
      <td>100.0</td>
      <td>39.850000</td>
      <td>23.950500</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 17 columns</p>
</div>

<p>$\rightarrow$ <strong>The target labels consist of 4 classes representing Time to Failure windows.</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The target labels
</span><span class="n">y_train</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([3, 2, 1, 0])
</code></pre></div></div>

<p><a id="cinq"></a></p>

<h1 id="5-exploratory-data-analysis-eda">5. Exploratory Data Analysis (EDA)</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dataCleaning</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span> 
    
    <span class="s">"""
    In order to have a proper visualisation, 
    some pre-exploration of the data has been done 
    leading to the following modifications
    """</span> 
       
    <span class="c1"># Some features have all their values set to NaN in the correlation matrix, we simply drop them
</span>    <span class="n">Data</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'s18'</span><span class="p">,</span> <span class="s">'s19'</span><span class="p">,</span><span class="s">'op_set_3'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1"># Some feature have 0 correlation with target and the other features, we drop them too
</span>    <span class="n">Data</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'op_set_1'</span><span class="p">,</span><span class="s">'op_set_2'</span><span class="p">,</span><span class="s">'s1'</span><span class="p">,</span><span class="s">'s5'</span><span class="p">,</span><span class="s">'s16'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1"># Some features are highly correlated (&gt;0.9), we drop one of them(s9,s14) (s8,s13) 
</span>    <span class="n">Data</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'s12'</span><span class="p">,</span><span class="s">'s13'</span><span class="p">,</span><span class="s">'s14'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">Data</span>
    
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">dataCleaning</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="distribution-of-all-engines-with-regards-to-their-failure-cycles">Distribution of all engines with regards to their failure cycles:</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cycles_per_engine</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'ID'</span><span class="p">)[</span><span class="s">'Cycle'</span><span class="p">].</span><span class="nb">max</span><span class="p">())</span>
<span class="n">cycles_per_engine</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">cycles_per_engine</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'ID'</span> <span class="p">,</span> <span class="s">'Cycles'</span><span class="p">]</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">cycles_per_engine</span><span class="p">.</span><span class="n">Cycles</span> <span class="p">,</span> <span class="n">bins</span><span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Distribution of engines with respect to their failure cycles"</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 1.0, 'Distribution of engines with respect to their failure cycles')
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_30_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cycles_per_engine</span><span class="p">.</span><span class="n">Cycles</span><span class="p">).</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cycles    256.25
Name: 0.75, dtype: float64
</code></pre></div></div>

<p>$\rightarrow$ <b>We notice that : 75% of the engines fail before reaching 257 cycles.</b></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># We will concatenat X_train and y_train for visualisation purposes. 
</span><span class="n">y</span><span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">X_conc</span><span class="o">=</span> <span class="n">X_train</span>
<span class="n">X_conc</span><span class="p">[</span><span class="s">'labels'</span><span class="p">]</span><span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="s">'labels'</span><span class="p">].</span><span class="n">values</span>
</code></pre></div></div>

<h3 id="number-of-observations-per-class">Number of observations per class</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ax</span><span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'labels'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">X_conc</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Number of observation per class "</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 1.0, 'Number of observation per class ')
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_35_1.png" alt="png" /></p>

<p>$\rightarrow$ <b>We notice that : The distribution between classes seems to be imbalanced.</b></p>

<h3 id="feature-correlation-matrix-">Feature correlation matrix :</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">feature_corr</span> <span class="o">=</span> <span class="n">X_conc</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:].</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">feature_corr</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">square</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="s">'.2f'</span><span class="p">,</span><span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s">'size'</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'coolwarm'</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_38_0.png" alt="png" /></p>

<h3 id="feature-distributions-">Feature distributions :</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ft_to_pairplot</span><span class="o">=</span><span class="p">[</span><span class="s">'s2'</span><span class="p">,</span><span class="s">'s3'</span><span class="p">,</span><span class="s">'s4'</span><span class="p">,</span><span class="s">'s8'</span><span class="p">,</span><span class="s">'s9'</span><span class="p">,</span><span class="s">'s11'</span><span class="p">,</span><span class="s">'s17'</span><span class="p">,</span><span class="s">'labels'</span><span class="p">]</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">X_conc</span><span class="p">[</span><span class="n">ft_to_pairplot</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s">"labels"</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="n">ft_to_pairplot</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">map_diag</span><span class="p">(</span><span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s">"step"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">map_upper</span><span class="p">(</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">map_lower</span><span class="p">(</span><span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">add_legend</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_40_0.png" alt="png" /></p>

<p>$\rightarrow$ <b>Here we used a  pairplot to see the bivariate relation between each pair of features and distribution of each feature. We notice that:</b></p>
<ul>
  <li>
    <p>Classes are not seperated across all feature combinations, there is an overlap in their pairwise relationships.</p>
  </li>
  <li>
    <p>Almost all features visualized above have normal distributions.</p>
  </li>
</ul>

<h3 id="relevant-features-inspection-">Relevant features inspection :</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">viz_func</span><span class="p">(</span><span class="n">eng_id</span><span class="p">,</span><span class="n">df</span><span class="p">):</span> 
    
    <span class="s">""" Plot time series of a single engine.
    
        Args:
        eng_id (int64): The id of the engine considered.

    Returns:
        plots
        
    """</span>
    <span class="n">subset</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">.</span><span class="n">ID</span><span class="o">==</span><span class="n">eng_id</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="k">print</span> <span class="p">(</span><span class="s">" Features inspection for engine : "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">eng_id</span><span class="p">))</span>
    <span class="c1">## Tempreture at LPC : 
</span>    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">s2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">legend</span><span class="p">([</span><span class="s">'s2(°R)'</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Tempretures at LPC outlet'</span><span class="p">)</span>
    
    <span class="c1">## Tempreture at HPC : 
</span>    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">s3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">legend</span><span class="p">([</span><span class="s">'s3(°R)'</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Tempretures at HPC outlet'</span><span class="p">)</span>
    
    <span class="c1">## Tempreture at LPT : 
</span>    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">s4</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">legend</span><span class="p">([</span><span class="s">'s4(°R)'</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Tempretures at LPT outlet'</span><span class="p">)</span>
    
    <span class="c1">## Static pressure at HPC outlet
</span>    
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">s11</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">legend</span><span class="p">([</span><span class="s">'s11(psia)'</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Static pressure at HPC outlet'</span><span class="p">)</span>
    
    <span class="c1">## Physical core speed
</span>    
    <span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">s9</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">legend</span><span class="p">([</span><span class="s">'s9(rpm)'</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Physical core speed'</span><span class="p">)</span>
    
    <span class="c1">## Physical fan speed
</span>    
    <span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">s8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">legend</span><span class="p">([</span><span class="s">'s8(rpm)'</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Physical fan speed'</span><span class="p">)</span>
    
    <span class="c1">## HPT coolant bleed
</span>    <span class="n">axes</span><span class="p">[</span><span class="mi">6</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">s20</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">6</span><span class="p">].</span><span class="n">legend</span><span class="p">([</span><span class="s">'s20(lbm/s)'</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">6</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'HPT coolant bleed'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'ttf =10'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'ttf =30'</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">'k'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'ttf =100'</span><span class="p">)</span>
        
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'**************'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span> <span class="p">,</span> <span class="n">axes</span>
</code></pre></div></div>

<h4 id="visualize-randomly-chosen-engines-">Visualize randomly chosen engines :</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Engines</span> <span class="o">=</span> <span class="n">X_conc</span><span class="p">[</span><span class="s">'ID'</span><span class="p">].</span><span class="n">unique</span><span class="p">()</span>
<span class="n">eng_ids</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">Engines</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">eng</span> <span class="ow">in</span> <span class="n">eng_ids</span><span class="p">:</span> 
    <span class="n">viz_func</span><span class="p">(</span><span class="n">eng</span><span class="p">,</span><span class="n">X_conc</span><span class="p">)</span>
    
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Features inspection for engine : 54
**************
 Features inspection for engine : 90
**************
 Features inspection for engine : 6
**************
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_45_1.png" alt="png" /></p>

<p><img src="/blog/images/aircraft_starting_kit_45_2.png" alt="png" /></p>

<p><img src="/blog/images/aircraft_starting_kit_45_3.png" alt="png" /></p>

<p>$\rightarrow$ <b>It is clear that the behaviour of sensors measurements differ from one class to another and especially when the number of cycles gets close to the failure point. These sensors measurements should then have been more explored in order to extract other valuable and informative information.</b></p>

<h3 id="classes-caracteristics">Classes caracteristics:</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">X_conc</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s">"labels"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"s2"</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fec555c0908&gt;
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_48_1.png" alt="png" /></p>

<p>$\rightarrow$ <b>Even though our features’ variances are quite low,these violinplots confirm the previous remark. </b></p>

<p><a id="six"></a></p>

<h1 id="6-features-extraction">6. Features extraction</h1>

<p>In order to have more informative and insightful data, we are going to generate new features using simple smoothing of the sensors’ measurements.<br />
Since the observations related to each engine could be considered as time series independent from the other engines’ observations, the above functions will take that into consideration and apply rolling standard deviation (respectively mean) over a defined period of time (number of cycles) of a defined feature of a each engine seperately.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">rolling_std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">cycle_window</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="s">"""
    For a given dataframe, compute the standard deviation over
    a defined period of time (number of cycles) of a defined feature

    Parameters
    ----------
    data : dataframe
    feature : str
        feature in the dataframe we wish to compute the rolling std from
    cycle_window : str
        string that defines the length of the cycle window passed to rolling
    center : bool
        boolean to indicate if the point of the dataframe considered is
        center or end of the window
    """</span>
    
    <span class="n">df_to_return</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span> 
    <span class="n">ids</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">ID</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'_'</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="n">feature</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">cycle_window</span><span class="p">),</span> <span class="s">'std'</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
        <span class="n">sub_eng</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">.</span><span class="n">ID</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_eng</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="n">rolling</span><span class="p">(</span><span class="n">cycle_window</span> <span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">).</span><span class="n">std</span><span class="p">()</span>
        <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">].</span><span class="n">ffill</span><span class="p">().</span><span class="n">bfill</span><span class="p">()</span>
        <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_eng</span><span class="p">[</span><span class="n">name</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="n">sub_eng</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">df_to_return</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_to_return</span> <span class="p">,</span> <span class="n">sub_eng</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_to_return</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">rolling_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">cycle_window</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="s">"""
    For a given dataframe, compute the mean over
    a defined period of time (number of cycles) of a defined feature

    Parameters
    ----------
    data : dataframe
    feature : str
        feature in the dataframe we wish to compute the rolling mean from
    cycle_window : str
        string that defines the length of the cycle window passed to rolling
    center : bool
        boolean to indicate if the point of the dataframe considered is
        center or end of the window
    """</span>
    
    <span class="n">df_to_return</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">ids</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">ID</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">'_'</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="n">feature</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">cycle_window</span><span class="p">),</span> <span class="s">'mean'</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
        <span class="n">sub_eng</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">.</span><span class="n">ID</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_eng</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="n">rolling</span><span class="p">(</span><span class="n">cycle_window</span><span class="p">,</span> <span class="n">win_type</span> <span class="o">=</span> <span class="s">'hamming'</span> <span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">].</span><span class="n">ffill</span><span class="p">().</span><span class="n">bfill</span><span class="p">()</span>
        <span class="n">sub_eng</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_eng</span><span class="p">[</span><span class="n">name</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="n">sub_eng</span><span class="p">[</span><span class="n">feature</span><span class="p">].</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">df_to_return</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_to_return</span> <span class="p">,</span> <span class="n">sub_eng</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_to_return</span>
</code></pre></div></div>

<p><a id="sept"></a></p>

<h1 id="7-classification-model">7. Classification model</h1>

<p>In order to evaluate the performance of the submissions, we provide a test set that can be loaded similarly as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_test</span> <span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">get_test_data</span><span class="p">()</span>
<span class="n">X_test</span><span class="p">.</span><span class="n">shape</span> <span class="p">,</span> <span class="n">y_test</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>((29692, 26), (29692,))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_test</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Cycle</th>
      <th>op_set_1</th>
      <th>op_set_2</th>
      <th>op_set_3</th>
      <th>s1</th>
      <th>s2</th>
      <th>...</th>
      <th>s15</th>
      <th>s16</th>
      <th>s17</th>
      <th>s18</th>
      <th>s19</th>
      <th>s20</th>
      <th>s21</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>0.0023</td>
      <td>0.0003</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>643.02</td>
      <td>...</td>
      <td>8.4052</td>
      <td>0.03</td>
      <td>392</td>
      <td>2388</td>
      <td>100.0</td>
      <td>38.86</td>
      <td>23.3735</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>-0.0027</td>
      <td>-0.0003</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>641.71</td>
      <td>...</td>
      <td>8.3803</td>
      <td>0.03</td>
      <td>393</td>
      <td>2388</td>
      <td>100.0</td>
      <td>39.02</td>
      <td>23.3916</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>0.0003</td>
      <td>0.0001</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>642.46</td>
      <td>...</td>
      <td>8.4441</td>
      <td>0.03</td>
      <td>393</td>
      <td>2388</td>
      <td>100.0</td>
      <td>39.08</td>
      <td>23.4166</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>4</td>
      <td>0.0042</td>
      <td>0.0000</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>642.44</td>
      <td>...</td>
      <td>8.3917</td>
      <td>0.03</td>
      <td>391</td>
      <td>2388</td>
      <td>100.0</td>
      <td>39.00</td>
      <td>23.3737</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
      <td>0.0014</td>
      <td>0.0000</td>
      <td>100.0</td>
      <td>518.67</td>
      <td>642.51</td>
      <td>...</td>
      <td>8.4031</td>
      <td>0.03</td>
      <td>390</td>
      <td>2388</td>
      <td>100.0</td>
      <td>38.99</td>
      <td>23.4130</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 20 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Reload train data without modifications to test the feature extractor
</span><span class="n">X_train</span> <span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">get_train_data</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">'./submissions/starting_kit/'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">feature_extractor</span> <span class="kn">import</span> <span class="n">FeatureExtractor</span>
<span class="kn">from</span> <span class="nn">classifier</span> <span class="kn">import</span> <span class="n">Classifier</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">FeatureExtractor</span><span class="p">(),</span> <span class="n">Classifier</span><span class="p">())</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred_proba</span><span class="o">=</span><span class="n">y_pred</span>
<span class="n">y_pred</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_pred</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([3, 3, 3, ..., 2, 2, 2])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_classes</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">y_bin</span> <span class="o">=</span> <span class="n">label_binarize</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</code></pre></div></div>

<p><a id="huit"></a></p>

<h1 id="8-evaluation">8. Evaluation</h1>

<h3 id="sklearn-metrics-">Sklearn metrics :</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="p">(</span><span class="s">"Accuracy : "</span><span class="p">,</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accuracy :  0.8004176209079887
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[    2,     0,    33,     0],
       [   20,     0,   533,    35],
       [    6,     0,  2728,  3144],
       [    0,     0,  2155, 21036]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>              precision    recall  f1-score   support

           0       0.07      0.06      0.06        35
           1       0.00      0.00      0.00       588
           2       0.50      0.46      0.48      5878
           3       0.87      0.91      0.89     23191

   micro avg       0.80      0.80      0.80     29692
   macro avg       0.36      0.36      0.36     29692
weighted avg       0.78      0.80      0.79     29692
</code></pre></div></div>

<h3 id="roc-curve">ROC curve</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fpr</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">tpr</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">fpr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tpr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_bin</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">y_pred_proba</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>


<span class="n">colors</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="s">'aqua'</span><span class="p">,</span> <span class="s">'darkorange'</span><span class="p">,</span> <span class="s">'cornflowerblue'</span><span class="p">,</span><span class="s">'r'</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_classes</span><span class="p">),</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tpr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s">'ROC curve of class {0} '</span>
             <span class="s">''</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'k--'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'False Positive Rate'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'True Positive Rate'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'ROC-AUC curve for each class with sklearn metrics'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_67_0.png" alt="png" /></p>

<p>$\rightarrow$<strong>High accuracy does not mean a performant model, true and false positives should be taken into cosideration.The above results seem to be good but in reality the classes are imbalanced and have different order of importance (urgency). That’s why we defined our proper metrics that respond to the problem’s needs (weighted metrics). </strong></p>

<h3 id="business-metrics">Business metrics</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">new_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_pred_proba</span><span class="p">):</span> 
    <span class="c1">## Multiclass Logloss
</span>    <span class="n">ll</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"log_loss : "</span><span class="p">,</span><span class="n">ll</span><span class="p">)</span>
    <span class="c1">## Weighted Precision
</span>    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
    <span class="n">class_score</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">w_prec</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">class_score</span> <span class="o">*</span> <span class="n">weights</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Weighted Precision : "</span><span class="p">,</span><span class="n">w_prec</span><span class="p">)</span>
    <span class="c1">## Weighted recall : 
</span>    <span class="n">weights_rec</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
    <span class="n">class_score</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">w_rec</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">class_score</span> <span class="o">*</span><span class="n">weights_rec</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Weighted recall : "</span><span class="p">,</span><span class="n">w_rec</span><span class="p">)</span>
    <span class="c1">## Macro Average F1
</span>    <span class="n">rec</span> <span class="o">=</span> <span class="n">w_rec</span>
    <span class="n">prec</span> <span class="o">=</span> <span class="n">w_prec</span>
    <span class="n">m_avg_f1</span><span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">prec</span> <span class="o">*</span> <span class="n">rec</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">prec</span> <span class="o">+</span> <span class="n">rec</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">**</span> <span class="o">-</span><span class="mi">15</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Macro Average F1 : "</span><span class="p">,</span><span class="n">m_avg_f1</span><span class="p">)</span>
    <span class="c1">## Mixed 
</span>    <span class="n">mixed</span> <span class="o">=</span> <span class="n">ll</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m_avg_f1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Mixed : "</span><span class="p">,</span><span class="n">mixed</span><span class="p">)</span>
    
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">new_metrics</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_pred</span><span class="p">,</span><span class="n">y_pred_proba</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>log_loss :  0.5046380836599733
Weighted Precision :  0.5048226478263285
Weighted recall :  0.16568937431274927
Macro Average F1 :  0.24949216686796474
Mixed :  1.2551459167920087
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_classes_proba</span><span class="p">(</span><span class="n">eng_id</span> <span class="p">,</span> <span class="n">X_test</span> <span class="p">,</span> <span class="n">y_test</span> <span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">):</span>
    <span class="s">""" Plot the probability of a certain class for a single engine.
    
        Args:
        eng_id : The id of the engine considered.
                
    Returns:
        plots
        
    """</span>
    <span class="c1"># Generate a dataframe having the praobability of predicted classes, the engines IDs, the cycles
</span>    <span class="c1"># and the true classes
</span>    
    <span class="n">df_y_pred_proba</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_pred_proba</span> <span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'Class_0'</span> <span class="p">,</span> <span class="s">'Class_1'</span> <span class="p">,</span> <span class="s">'Class_2'</span> <span class="p">,</span> <span class="s">'Class_3'</span><span class="p">])</span>
    <span class="n">df_y_pred_proba</span><span class="p">[</span><span class="s">'ID'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="s">'ID'</span><span class="p">].</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df_y_pred_proba</span><span class="p">[</span><span class="s">'Cycle'</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="s">'Cycle'</span><span class="p">].</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df_y_pred_proba</span><span class="p">[</span><span class="s">'y_true'</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_test</span>

    
    <span class="n">subset</span> <span class="o">=</span> <span class="n">df_y_pred_proba</span><span class="p">[</span><span class="n">df_y_pred_proba</span><span class="p">.</span><span class="n">ID</span> <span class="o">==</span> <span class="n">eng_id</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">Class_0</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Class_0'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">Class_1</span> <span class="p">,</span> <span class="s">'r'</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Class_1'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">Class_2</span> <span class="p">,</span> <span class="s">'g'</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Class_2'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subset</span><span class="p">.</span><span class="n">Cycle</span> <span class="p">,</span> <span class="n">subset</span><span class="p">.</span><span class="n">Class_3</span> <span class="p">,</span> <span class="s">'y'</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'Class_3'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Probability of class for engine : '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">eng_id</span><span class="p">))</span>
    
    <span class="n">classes</span> <span class="o">=</span> <span class="n">subset</span><span class="p">.</span><span class="n">y_true</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span>
    
    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">clr</span> <span class="o">=</span> <span class="p">[</span><span class="s">'r'</span><span class="p">,</span><span class="s">'g'</span><span class="p">,</span><span class="s">'y'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="n">subset</span><span class="p">.</span><span class="n">y_true</span> <span class="o">==</span> <span class="n">classes</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">t</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">clr</span><span class="p">[</span><span class="mi">2</span><span class="o">-</span><span class="n">i</span><span class="p">])</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">t</span>
    
    <span class="k">return</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eng_id</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">Engines</span><span class="p">)</span>
<span class="n">plot_classes_proba</span><span class="p">(</span><span class="n">eng_id</span> <span class="p">,</span> <span class="n">X_test</span> <span class="p">,</span> <span class="n">y_test</span> <span class="p">,</span> <span class="n">y_pred_proba</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/blog/images/aircraft_starting_kit_73_0.png" alt="png" /></p>

<p>$\rightarrow$ <b>In the figure above, we clearly notice that we have a problem of a late alarm. In fact, when the true value of the class is 1, our model assigns the higher probability to the class 2 (the segment between the red and green vertical lines). Therefore, we are predicting that our system is confident while it has in reality less than 30 cycles until failure. This can cause an unexpected damage to the aircraft’s engine. </b><br />
$\rightarrow$ <b>We can also be in the case of an early alarm. For example, an engine is a confident system while our model predicts it needs an urgent maintenance. This may involve a useless maintenance and a significant economic burden for the company.</b></p>

<p><a id="neuf"></a></p>
<h1 id="9-local-testing">9. Local testing</h1>

<p>First install ramp-workflow, make sure that the python files feature_extractor.py and classifier.py are in the submission/starting_kit floder then run the following command.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">ramp_test_submission</span> <span class="o">--</span><span class="n">submission</span> <span class="n">starting_kit</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[38;5;178m[1mTesting Predictive maintenance for aircraft engines[0m
[38;5;178m[1mReading train and test files from ./data ...[0m
[38;5;178m[1mReading cv ...[0m
[38;5;178m[1mTraining ./submissions/starting_kit ...[0m
[38;5;178m[1mCV fold 0[0m
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:758: ConvergenceWarning: lbfgs failed to converge. Increase the number of iterations.
  "of iterations.", ConvergenceWarning)
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
	[38;5;178m[1mscore  mixed  mc_ll  w_prec  w_rec[0m
	[38;5;10m[1mtrain[0m   [38;5;10m[1m1.13[0m   [38;5;150m0.60[0m    [38;5;150m0.67[0m   [38;5;150m0.36[0m
	[38;5;12m[1mvalid[0m   [38;5;12m[1m1.15[0m   [38;5;105m0.55[0m    [38;5;105m0.63[0m   [38;5;105m0.30[0m
	[38;5;1m[1mtest[0m    [38;5;1m[1m1.02[0m   [38;5;218m0.41[0m    [38;5;218m0.66[0m   [38;5;218m0.27[0m
[38;5;178m[1mCV fold 1[0m
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:758: ConvergenceWarning: lbfgs failed to converge. Increase the number of iterations.
  "of iterations.", ConvergenceWarning)
	[38;5;178m[1mscore  mixed  mc_ll  w_prec  w_rec[0m
	[38;5;10m[1mtrain[0m   [38;5;10m[1m1.19[0m   [38;5;150m0.60[0m    [38;5;150m0.69[0m   [38;5;150m0.29[0m
	[38;5;12m[1mvalid[0m   [38;5;12m[1m1.26[0m   [38;5;105m0.65[0m    [38;5;105m0.64[0m   [38;5;105m0.28[0m
	[38;5;1m[1mtest[0m    [38;5;1m[1m1.09[0m   [38;5;218m0.43[0m    [38;5;218m0.64[0m   [38;5;218m0.24[0m
[38;5;178m[1mCV fold 2[0m
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:758: ConvergenceWarning: lbfgs failed to converge. Increase the number of iterations.
  "of iterations.", ConvergenceWarning)
	[38;5;178m[1mscore  mixed  mc_ll  w_prec  w_rec[0m
	[38;5;10m[1mtrain[0m   [38;5;10m[1m1.25[0m   [38;5;150m0.64[0m    [38;5;150m0.62[0m   [38;5;150m0.29[0m
	[38;5;12m[1mvalid[0m   [38;5;12m[1m1.21[0m   [38;5;105m0.68[0m    [38;5;105m0.64[0m   [38;5;105m0.38[0m
	[38;5;1m[1mtest[0m    [38;5;1m[1m1.13[0m   [38;5;218m0.47[0m    [38;5;218m0.65[0m   [38;5;218m0.23[0m
[38;5;178m[1mCV fold 3[0m
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:758: ConvergenceWarning: lbfgs failed to converge. Increase the number of iterations.
  "of iterations.", ConvergenceWarning)
	[38;5;178m[1mscore  mixed  mc_ll  w_prec  w_rec[0m
	[38;5;10m[1mtrain[0m   [38;5;10m[1m1.12[0m   [38;5;150m0.60[0m    [38;5;150m0.68[0m   [38;5;150m0.37[0m
	[38;5;12m[1mvalid[0m   [38;5;12m[1m1.16[0m   [38;5;105m0.61[0m    [38;5;105m0.65[0m   [38;5;105m0.34[0m
	[38;5;1m[1mtest[0m    [38;5;1m[1m1.05[0m   [38;5;218m0.41[0m    [38;5;218m0.64[0m   [38;5;218m0.26[0m
[38;5;178m[1mCV fold 4[0m
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/linear_model/logistic.py:758: ConvergenceWarning: lbfgs failed to converge. Increase the number of iterations.
  "of iterations.", ConvergenceWarning)
	[38;5;178m[1mscore  mixed  mc_ll  w_prec  w_rec[0m
	[38;5;10m[1mtrain[0m   [38;5;10m[1m1.10[0m   [38;5;150m0.59[0m    [38;5;150m0.68[0m   [38;5;150m0.39[0m
	[38;5;12m[1mvalid[0m   [38;5;12m[1m1.22[0m   [38;5;105m0.69[0m    [38;5;105m0.65[0m   [38;5;105m0.37[0m
	[38;5;1m[1mtest[0m    [38;5;1m[1m0.97[0m   [38;5;218m0.43[0m    [38;5;218m0.69[0m   [38;5;218m0.34[0m
[38;5;178m[1m----------------------------[0m
[38;5;178m[1mMean CV scores[0m
[38;5;178m[1m----------------------------[0m
	[38;5;178m[1mscore         mixed         mc_ll        w_prec         w_rec[0m
	[38;5;10m[1mtrain[0m  [38;5;10m[1m1.16[0m [38;5;150m[38;5;150m[38;5;150m[38;5;150m±[0m[0m[0m[0m [38;5;150m0.054[0m  [38;5;150m0.61[0m [38;5;150m[38;5;150m[38;5;150m[38;5;150m±[0m[0m[0m[0m [38;5;150m0.018[0m  [38;5;150m0.67[0m [38;5;150m[38;5;150m[38;5;150m[38;5;150m±[0m[0m[0m[0m [38;5;150m0.024[0m  [38;5;150m0.34[0m [38;5;150m[38;5;150m[38;5;150m[38;5;150m±[0m[0m[0m[0m [38;5;150m0.041[0m
	[38;5;12m[1mvalid[0m   [38;5;12m[1m1.2[0m [38;5;105m[38;5;105m[38;5;105m[38;5;105m±[0m[0m[0m[0m [38;5;105m0.042[0m  [38;5;105m[38;5;105m0.64[0m[0m [38;5;105m[38;5;105m[38;5;105m[38;5;105m±[0m[0m[0m[0m [38;5;105m0.051[0m  [38;5;105m[38;5;105m0.64[0m[0m [38;5;105m[38;5;105m[38;5;105m[38;5;105m±[0m[0m[0m[0m [38;5;105m0.008[0m  [38;5;105m0.33[0m [38;5;105m[38;5;105m[38;5;105m[38;5;105m±[0m[0m[0m[0m [38;5;105m0.038[0m
	[38;5;1m[1mtest[0m   [38;5;1m[1m1.05[0m [38;5;218m[38;5;218m[38;5;218m[38;5;218m±[0m[0m[0m[0m [38;5;218m0.054[0m  [38;5;218m0.43[0m [38;5;218m[38;5;218m[38;5;218m[38;5;218m±[0m[0m[0m[0m [38;5;218m0.024[0m  [38;5;218m0.66[0m [38;5;218m[38;5;218m[38;5;218m[38;5;218m±[0m[0m[0m[0m [38;5;218m0.016[0m  [38;5;218m0.27[0m [38;5;218m[38;5;218m[38;5;218m[38;5;218m±[0m[0m[0m[0m [38;5;218m0.038[0m
[38;5;178m[1m----------------------------[0m
[38;5;178m[1mBagged scores[0m
[38;5;178m[1m----------------------------[0m
/home/aymen/anaconda3/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
	[38;5;178m[1mscore  mixed[0m
	[38;5;12m[1mvalid[0m   [38;5;12m[1m1.20[0m
	[38;5;1m[1mtest[0m    [38;5;1m[1m1.06[0m
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

    </div><!-- .post-content -->
    <div class="post-share">
      <span>Share:</span>
      <a target="_blank"
        href="https://twitter.com/intent/tweet?text=RAMP%20on%20Predictive%20Maintenance%20for%20Aircraft%20Engines&amp;url=http://localhost:4000/blog/aircraft-starting-kit" rel="noopener">Twitter</a>
      <a target="_blank"
        href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/blog/aircraft-starting-kit&amp;t=RAMP%20on%20Predictive%20Maintenance%20for%20Aircraft%20Engines" rel="noopener">Facebook</a>
    </div><!-- .share-post -->
    <div class="author-box">
      
      <div class="author-avatar" style="background-image: url('images/author.png')"><span class="screen-reader-text">Ahmed Akakzia's Picture</span></div>
      
      <div class="author-details">
        <h2 class="author-title">About Ahmed Akakzia</h2>
        <div class="author-bio"><p>Ahmed is a final year PhD candidate, passionate about artificial intelligence</p>
</div>
        
        <span class="author-location">Paris, France</span>
        
        
      </div><!-- .author-details -->
    </div><!-- .author-box -->
  </article><!-- .post -->

  
    <div class="comments-area">
  <div class="comments-inner">
    <h2 class="comments-title">Comments</h2>
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
        Disqus</a>.</noscript>
  </div><!-- .comments-inner -->
</div><!-- .comments-area -->

<script type="text/javascript">
  var disqus_shortname = 'justgoodthemes';
  var disqus_developer = 0;
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
  
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</main><!-- .main-content -->
      <footer class="site-footer">
  <div class="offsite-links">
    
      
<a href="https://twitter.com/aakakzia" target="_blank" rel="noopener">
  <span class="fa-twitter" aria-hidden="true"></span>
  <span class="screen-reader-text">Twitter</span>
</a>

<a href="https://github.com/akakzia" target="_blank" rel="noopener">
  <span class="fa-github" aria-hidden="true"></span>
  <span class="screen-reader-text">GitHub</span>
</a>

<a href="https://www.linkedin.com/in/ahmed-akakzia/" target="_blank" rel="noopener">
  <span class="fa-linkedin" aria-hidden="true"></span>
  <span class="screen-reader-text">LinkedIn</span>
</a>

    
  </div><!-- .offsite-links -->
  <div class="footer-bottom">
    <div class="site-info">
      <p>© 2022 Ahmed Akakzia. Theme customized from <a href="https://www.justgoodthemes.com">JustGoodThemes</a>.</p>

    </div><!-- .site-info -->
    <a href="#page" id="back-to-top" class="back-to-top"><span class="screen-reader-text">Back to the top </span>&#8593;</a>
  </div><!-- .footer-bottom -->
</footer><!-- .site-footer -->

    </div><!-- .inner -->
  </div><!-- .site -->

  <!-- Scripts -->
  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>
  
  <script src="/blog/assets/js/plugins.js"></script>
  <script src="/blog/assets/js/custom.js"></script>

</body>
</html>